From 59ace120ac5ceb5f0d36e40e48e1884de1badf76 Mon Sep 17 00:00:00 2001
From: Michiel Rook <mrook@php.net>
Date: Thu, 20 Dec 2018 19:11:37 +0100
Subject: [PATCH] Don't allow filenames to start with phar://

---
 Archive/Tar.php | 3 +++
 1 file changed, 3 insertions(+)

Index: php-pear-1.10.1+submodules+notgz/submodules/Archive_Tar/Archive/Tar.php
===================================================================
--- php-pear-1.10.1+submodules+notgz.orig/submodules/Archive_Tar/Archive/Tar.php	2019-01-11 13:24:14.414872841 -0500
+++ php-pear-1.10.1+submodules+notgz/submodules/Archive_Tar/Archive/Tar.php	2019-01-11 13:24:14.410872828 -0500
@@ -1725,6 +1725,9 @@ class Archive_Tar extends PEAR
      */
     private function _maliciousFilename($file)
     {
+        if (strpos($file, 'phar://') === 0) {
+            return true;
+        }
         if (strpos($file, '/../') !== false) {
             return true;
         }
